<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Battle City</title>
  
  <script type="text/javascript" src="lib/jquery-1.7.2.js"></script>

  <script type="text/javascript" src="src/Utils.js"></script>
  <script type="text/javascript" src="src/Point.js"></script>
  <script type="text/javascript" src="src/Rect.js"></script>
  <script type="text/javascript" src="src/Sprite.js"></script>
  <script type="text/javascript" src="src/Tank.js"></script>
  <script type="text/javascript" src="src/Wall.js"></script>
  <script type="text/javascript" src="src/SpriteContainer.js"></script>
  <script type="text/javascript" src="src/CollisionDetector.js"></script>
  <script type="text/javascript" src="src/EventManager.js"></script>
  <script type="text/javascript" src="src/SpriteController.js"></script>
  <script type="text/javascript" src="src/TankController.js"></script>
  <script type="text/javascript" src="src/Keyboard.js"></script>
  <script type="text/javascript" src="src/BulletFactory.js"></script>
  <script type="text/javascript" src="src/Bullet.js"></script>
  <script type="text/javascript" src="src/Painter.js"></script>
  <script type="text/javascript" src="src/Updater.js"></script>
  <script type="text/javascript" src="src/BulletExplosionFactory.js"></script>
  <script type="text/javascript" src="src/Explosion.js"></script>
  <script type="text/javascript" src="src/BulletExplosion.js"></script>
  <script type="text/javascript" src="src/BrickWall.js"></script>
  <script type="text/javascript" src="src/SteelWall.js"></script>
  <script type="text/javascript" src="src/Cursor.js"></script>
  <script type="text/javascript" src="src/BlinkTimer.js"></script>
  <script type="text/javascript" src="src/CursorController.js"></script>
  <script type="text/javascript" src="src/Builder.js"></script>
  <script type="text/javascript" src="src/StructureManager.js"></script>
  <script type="text/javascript" src="src/BrickWallFactory.js"></script>
  <script type="text/javascript" src="src/SteelWallFactory.js"></script>
  <script type="text/javascript" src="src/Globals.js"></script>
  <script type="text/javascript" src="src/SpriteSerializer.js"></script>
  <script type="text/javascript" src="src/Base.js"></script>
  <script type="text/javascript" src="src/TankStateAppearing.js"></script>
  <script type="text/javascript" src="src/TankStateNormal.js"></script>
  <script type="text/javascript" src="src/TankStateInvincible.js"></script>
  <script type="text/javascript" src="src/AITankController.js"></script>
  <script type="text/javascript" src="src/Random.js"></script>
  <script type="text/javascript" src="src/AITankControllerFactory.js"></script>
  <script type="text/javascript" src="src/AITankControllerContainer.js"></script>
  <script type="text/javascript" src="src/EnemyFactory.js"></script>
  <script type="text/javascript" src="src/Animation.js"></script>
  <script type="text/javascript" src="src/TankExplosionFactory.js"></script>
  <script type="text/javascript" src="src/TankExplosion.js"></script>
  <script type="text/javascript" src="src/PointsFactory.js"></script>
  <script type="text/javascript" src="src/Points.js"></script>
  <script type="text/javascript" src="src/PlayerTankFactory.js"></script>
  <script type="text/javascript" src="src/PlayerTankControllerFactory.js"></script>
  <script type="text/javascript" src="src/PowerUpFactory.js"></script>
  <script type="text/javascript" src="src/PowerUp.js"></script>
  <script type="text/javascript" src="src/PowerUpHandler.js"></script>
  <script type="text/javascript" src="src/FreezeTimer.js"></script>
  <script type="text/javascript" src="src/BaseWallBuilder.js"></script>
  <script type="text/javascript" src="src/ShovelHandler.js"></script>
  <script type="text/javascript" src="src/Pause.js"></script>
  <script type="text/javascript" src="src/PauseListener.js"></script>
  <script type="text/javascript" src="src/BaseExplosionFactory.js"></script>
  <script type="text/javascript" src="src/BaseExplosion.js"></script>
  <script type="text/javascript" src="src/TankColor.js"></script>
  <script type="text/javascript" src="src/SceneManager.js"></script>
  <script type="text/javascript" src="src/MainMenuScene.js"></script>
  <script type="text/javascript" src="src/MainMenuItem.js"></script>
  <script type="text/javascript" src="src/OnePlayerMenuItem.js"></script>
  <script type="text/javascript" src="src/ConstructionMenuItem.js"></script>
  <script type="text/javascript" src="src/MainMenu.js"></script>
  <script type="text/javascript" src="src/MainMenuController.js"></script>
  <script type="text/javascript" src="src/MainMenuView.js"></script>
  <script type="text/javascript" src="src/MainMenuCursor.js"></script>
  <script type="text/javascript" src="src/MainMenuCursorView.js"></script>
  <script type="text/javascript" src="src/Gamefield.js"></script>
  <script type="text/javascript" src="src/Level.js"></script>
  <script type="text/javascript" src="src/EnemyFactoryView.js"></script>
  <script type="text/javascript" src="src/LivesView.js"></script>
  <script type="text/javascript" src="src/Curtain.js"></script>
  <script type="text/javascript" src="src/Script.js"></script>
  <script type="text/javascript" src="src/Delay.js"></script>
  <script type="text/javascript" src="src/GameScene.js"></script>
  <script type="text/javascript" src="src/StageMessage.js"></script>
  <script type="text/javascript" src="src/Stages.js"></script>
  <script type="text/javascript" src="src/MoveFn.js"></script>
  <script type="text/javascript" src="src/GameOverMessage.js"></script>
  <script type="text/javascript" src="src/StageStatisticsScene.js"></script>
  <script type="text/javascript" src="src/GameOverScene.js"></script>
  <script type="text/javascript" src="src/Player.js"></script>
  <script type="text/javascript" src="src/StageStatisticsPoints.js"></script>
  <script type="text/javascript" src="src/Trees.js"></script>
  <script type="text/javascript" src="src/Water.js"></script>
  <script type="text/javascript" src="src/LoadingScene.js"></script>

  <script type="text/javascript" src="lib/Stats.js"></script>
  <script type="text/javascript" src="src/FPSCounter.js"></script>
  
  <script type="text/javascript" src="src/ImageManager.js"></script>
  <script type="text/javascript" src="src/Construction.js"></script>
  <script type="text/javascript" src="src/SpriteSerializerController.js"></script>
  <script type="text/javascript" src="src/SoundManager.js"></script>

  <style>
    @font-face {
      font-family: prstart;
      src: url('../fonts/prstart.ttf');
    }
    body {
      font-family: prstart;
      font-size: 16px;
      background-color: black;
      margin-top: 30px;
    }
    /* Центрируем блок, но даём ему max-width, чтобы он мог ужаться */
    #main {
      margin: 0 auto;
      width: 512px; 
      max-width: 90%;
      color: white;
    }
    #help {
      border-top: 4px solid white;
      margin-top: 10px;
      padding-top: 7px;
    }
    /* Центрируем таблицу */
    #help table {
      margin: 0 auto;
    }
    #help img {
      vertical-align: middle;
      /* Можно добавить, чтобы картинки тоже подстраивались */
      max-width: 100%;
      height: auto;
    }
    #help td {
      padding-left: 1em;
    }
    /* Масштабируем канву пропорционально */
    #main canvas {
      width: 100%;
      height: auto;
      display: block;
    }
    .touch-button {
    display: inline-block;
    touch-action: none;
    -webkit-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
    cursor: pointer;
}
  </style>

  <script type="text/javascript">
    $(function () {
      var FPS = 50;
      
      var CANVAS_ID = 'canvas';
      var ctx = createCanvasContext();
      ctx.font = "16px prstart";
      
      var eventManager = new EventManager();
      var keyboard = new Keyboard(eventManager);
      var sceneManager = new SceneManager(eventManager);
      sceneManager.toLoadingScene();
      
      setInterval(gameLoop, 1000 / FPS);
      
      function gameLoop() {
        keyboard.fireEvents();
        sceneManager.update();
        sceneManager.draw(ctx);
      }
      
      function createCanvasContext() {
        $('<canvas id="' + CANVAS_ID + '" width="' + Globals.CANVAS_WIDTH + '" height="' + Globals.CANVAS_HEIGHT + '"></canvas>').prependTo('#main');
        var canvas = document.getElementById(CANVAS_ID);
        return canvas.getContext('2d');
      }

      // Пример: Можно вешать тач-события на «touch-button»
      $(document).on('touchstart mousedown pointerdown', '.touch-button', function(e) {
        e.preventDefault();
        var action = $(this).data('action');
        console.log('Touch/Mouse down on: ', action);
      });
      $(document).on('touchend mouseup pointerup', '.touch-button', function(e) {
        e.preventDefault();
        var action = $(this).data('action');
        console.log('Touch/Mouse up on: ', action);
      });
    });
  </script>
</head>
<body>
  <div id="main">
    <div id="help">
      <p>CONTROLS:</p>
      <table>
        <tr>
          <td>
            <img src="images/Nintendo-Dpad-Neutral.png" alt="" 
                 class="touch-button" data-action="arrows" />
          </td>
          <td>ARROWS</td>
        </tr>
        <tr>
          <td>
            <img src="images/Nintendo-Button-A.png" alt="" 
                 class="touch-button" data-action="space" />
            <img src="images/Nintendo-Button-B.png" alt="" 
                 class="touch-button" data-action="space" />
          </td>
          <td>SPACE</td>
        </tr>
        <tr>
          <td>
            <img src="images/Nintendo-Button-Start.png" alt="" 
                 class="touch-button" data-action="enter" />
          </td>
          <td>ENTER</td>
        </tr>
        <tr>
          <td>
            <img src="images/Nintendo-Button-Select.png" alt="" 
                 class="touch-button" data-action="ctrl" />
          </td>
          <td>CTRL</td>
        </tr>
      </table>
    </div>
  </div>
</body>
</html>
